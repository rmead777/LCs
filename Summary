<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Letter of Credit Renewal Applications - June 2025</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
    
    // Bulk update function
    window.bulkUpdate = function(columnIndex, bulkDropdownId) {
        const bulkDropdown = document.getElementById(bulkDropdownId);
        const selectedValue = bulkDropdown.value;
        
        if (!selectedValue) {
            alert('Please select a status to apply to all LCs');
            return;
        }
        
        // Get all rows in the table
        const rows = document.querySelectorAll('.lc-status-table tbody tr');
        let updatedCount = 0;
        
        rows.forEach(row => {
            const dropdowns = row.querySelectorAll('.status-dropdown');
            if (dropdowns.length > columnIndex) {
                dropdowns[columnIndex].value = selectedValue;
                
                // Add visual feedback
                dropdowns[columnIndex].style.background = '#dcfce7';
                setTimeout(() => {
                    dropdowns[columnIndex].style.background = '';
                }, 800);
                
                updatedCount++;
            }
        });
        
        // Reset the bulk dropdown
        bulkDropdown.value = '';
        
        // Update all status indicators
        updateStatus();
        
        // Show confirmation
        const confirmMsg = `✅ Updated ${updatedCount} LCs to "${selectedValue}"`;
        
        // Create a temporary notification
        const notification = document.createElement('div');
        notification.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background: #10b981;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            font-weight: 600;
            animation: slideIn 0.3s ease;
        `;
        notification.textContent = confirmMsg;
        document.body.appendChild(notification);
        
        // Remove notification after 3 seconds
        setTimeout(() => {
            notification.remove();
        }, 3000);
    }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f8f9fa;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.2em;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .header .subtitle {
            font-size: 1.1em;
            opacity: 0.9;
            font-weight: 300;
        }

        .content {
            padding: 30px;
        }

        .executive-summary {
            background: #f1f5f9;
            border-left: 4px solid #3b82f6;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 0 8px 8px 0;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .summary-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }

        .summary-item strong {
            color: #1e40af;
            display: block;
            margin-bottom: 5px;
        }

        .section {
            margin-bottom: 40px;
        }

        .section-header {
            background: #1f2937;
            color: white;
            padding: 15px 20px;
            margin: 0 -30px 20px -30px;
            font-size: 1.3em;
            font-weight: 600;
        }

        .lc-card {
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 10px;
            margin-bottom: 25px;
            overflow: hidden;
            transition: box-shadow 0.3s ease;
        }

        .lc-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .lc-header {
            background: #f9fafb;
            padding: 18px 20px;
            border-bottom: 1px solid #e5e7eb;
        }

        .lc-number {
            font-size: 1.1em;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 5px;
        }

        .lc-amount {
            font-size: 1.4em;
            font-weight: 700;
            color: #059669;
        }

        .lc-body {
            padding: 20px;
        }

        .detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 15px;
        }

        .detail-group h4 {
            color: #374151;
            font-weight: 600;
            margin-bottom: 8px;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 5px;
        }

        .detail-group p {
            margin-bottom: 5px;
            font-size: 0.95em;
        }

        .renewal-terms {
            background: #ecfdf5;
            border: 1px solid #10b981;
            border-radius: 6px;
            padding: 12px;
            margin-top: 15px;
        }

        .renewal-terms h4 {
            color: #065f46;
            margin-bottom: 8px;
        }

        .tag {
            display: inline-block;
            background: #dbeafe;
            color: #1e40af;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.85em;
            font-weight: 500;
            margin-right: 8px;
            margin-bottom: 5px;
            white-space: nowrap;
        }

        .tag.utility { background: #fef3c7; color: #92400e; }
        .tag.regulatory { background: #fee2e2; color: #991b1b; }
        .tag.municipal { background: #e0e7ff; color: #3730a3; }

        .table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .table th {
            background: #f3f4f6;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #e5e7eb;
        }

        .table td {
            padding: 12px;
            border-bottom: 1px solid #f3f4f6;
        }

        .table tr:hover {
            background: #f9fafb;
        }

        .action-items {
            background: #fef7ed;
            border: 2px solid #f59e0b;
            border-radius: 10px;
            padding: 20px;
            margin: 30px 0;
        }

        .action-items h3 {
            color: #92400e;
            margin-bottom: 15px;
        }

        .checklist {
            list-style: none;
        }

        .checklist li {
            margin-bottom: 8px;
            padding-left: 25px;
            position: relative;
        }

        .checklist li:before {
            content: "✅";
            position: absolute;
            left: 0;
        }

        .dashboard {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border: 2px solid #3b82f6;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .dashboard h2 {
            color: #1e40af;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.5em;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e5e7eb;
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 20px;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981 0%, #059669 100%);
            width: 15%;
            transition: width 0.5s ease;
            border-radius: 15px;
            box-shadow: 0 2px 4px rgba(16, 185, 129, 0.3);
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #1f2937;
            font-weight: 700;
            font-size: 1em;
            text-shadow: 0 1px 2px rgba(255,255,255,0.8);
            white-space: nowrap;
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .status-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border-left: 5px solid #6b7280;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .status-item.pending { border-left-color: #f59e0b; }
        .status-item.in-progress { border-left-color: #3b82f6; }
        .status-item.completed { border-left-color: #10b981; }
        .status-item.at-risk { border-left-color: #ef4444; }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-indicator.pending { background: #f59e0b; }
        .status-indicator.in-progress { background: #3b82f6; }
        .status-indicator.completed { background: #10b981; }
        .status-indicator.at-risk { background: #ef4444; }

        .lc-status-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .lc-status-table th {
            background: #f8fafc;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #e5e7eb;
            font-size: 0.9em;
        }

        .lc-status-table td {
            padding: 10px 12px;
            border-bottom: 1px solid #f3f4f6;
            font-size: 0.85em;
        }

        .status-dropdown {
            background: none;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 0.8em;
            cursor: pointer;
        }

        .contact-section {
            background: #f1f5f9;
            border: 2px solid #64748b;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .contact-section h2 {
            color: #475569;
            margin-bottom: 20px;
            text-align: center;
        }

        .contact-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .contact-card {
            background: white;
            border-radius: 8px;
            padding: 18px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .contact-card h4 {
            color: #1f2937;
            margin-bottom: 12px;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 5px;
        }

        .editable-field {
            border: 1px dashed #9ca3af;
            padding: 5px 8px;
            margin: 2px 0;
            background: #f9fafb;
            border-radius: 4px;
            min-height: 20px;
            cursor: text;
        }

        .editable-field:hover {
            background: #f3f4f6;
            border-color: #6b7280;
        }

        .editable-field:focus {
            outline: 2px solid #3b82f6;
            background: white;
            border-color: #3b82f6;
        }

        .bulk-update-btn {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75em;
            cursor: pointer;
            margin-top: 3px;
            transition: background 0.2s ease;
        }

        .bulk-update-btn:hover {
            background: #2563eb;
        }

        .bulk-update-btn:active {
            background: #1d4ed8;
            transform: scale(0.95);
        }

        .column-header {
            text-align: center;
        }

        .bulk-dropdown {
            background: #f8fafc;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            padding: 2px 4px;
            font-size: 0.7em;
            margin-top: 3px;
            width: 100%;
        }

        .export-section {
            background: #f0f9ff;
            border: 2px solid #0ea5e9;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .export-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .export-btn {
            background: #0ea5e9;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .export-btn:hover {
            background: #0284c7;
        }

        .export-btn.secondary {
            background: #6b7280;
        }

        .export-btn.secondary:hover {
            background: #4b5563;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .field-label {
            font-weight: 600;
            color: #374151;
            font-size: 0.85em;
            margin-bottom: 3px;
            display: block;
        }

        .excluded-section {
            background: #f3f4f6;
            border: 2px dashed #6b7280;
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
        }

        .excluded-section h3 {
            color: #4b5563;
            margin-bottom: 15px;
        }

        .highlight {
            background: #fef3c7;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: 600;
        }

        .note {
            background: #eff6ff;
            border-left: 4px solid #3b82f6;
            padding: 12px;
            margin: 10px 0;
            border-radius: 0 6px 6px 0;
        }

        .table-wrapper {
            overflow-x: auto;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            -webkit-overflow-scrolling: touch;
        }

        .table-wrapper::-webkit-scrollbar {
            height: 8px;
        }

        .table-wrapper::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .table-wrapper::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }

        .table-wrapper::-webkit-scrollbar-thumb:hover {
            background: #a1a1a1;
        }

        @media print {
            body { background: white; }
            .container { box-shadow: none; }
            .lc-card { break-inside: avoid; }
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .container {
                border-radius: 8px;
            }

            .header {
                padding: 20px 15px;
            }

            .header h1 {
                font-size: 1.8em;
            }

            .header .subtitle {
                font-size: 1em;
            }

            .content { 
                padding: 15px; 
            }

            .section-header { 
                margin: 0 -15px 20px -15px; 
                padding: 12px 15px;
                font-size: 1.1em;
            }

            .progress-bar {
                height: 35px;
                border-radius: 18px;
            }

            .progress-fill {
                border-radius: 18px;
            }

            .progress-text {
                font-size: 0.95em;
            }

            .dashboard,
            .contact-section {
                padding: 15px;
                margin-bottom: 20px;
            }

            .status-grid,
            .contact-grid { 
                grid-template-columns: 1fr; 
                gap: 10px;
            }

            .lc-status-table {
                font-size: 0.75em;
                min-width: 700px;
            }

            .lc-status-table th,
            .lc-status-table td {
                padding: 6px 4px;
            }

            .status-dropdown {
                font-size: 0.7em;
                padding: 2px 4px;
            }

            .detail-grid { 
                grid-template-columns: 1fr; 
                gap: 15px;
            }

            .summary-grid { 
                grid-template-columns: 1fr; 
                gap: 10px;
            }

            .lc-card {
                margin-bottom: 20px;
            }

            .lc-header {
                padding: 15px;
            }

            .lc-number {
                font-size: 1em;
                line-height: 1.3;
            }

            .lc-amount {
                font-size: 1.2em;
            }

            .lc-body {
                padding: 15px;
            }

            .tag {
                font-size: 0.8em;
                padding: 3px 6px;
                margin-bottom: 3px;
                display: inline-block;
                width: auto;
            }

            .table {
                font-size: 0.85em;
            }

            .table th,
            .table td {
                padding: 8px;
                word-break: break-word;
            }

            .executive-summary {
                padding: 15px;
                margin-bottom: 20px;
            }

            .action-items {
                padding: 15px;
                margin: 20px 0;
            }

            .excluded-section {
                padding: 15px;
                margin-top: 20px;
            }

            .note {
                padding: 10px;
                margin: 8px 0;
            }

            .renewal-terms {
                padding: 10px;
                margin-top: 12px;
            }
        }

        @media (max-width: 480px) {
            .progress-bar {
                height: 40px;
                border-radius: 20px;
            }

            .progress-fill {
                border-radius: 20px;
            }

            .progress-text {
                font-size: 0.85em;
                font-weight: 800;
            }

            .header h1 {
                font-size: 1.5em;
            }

            .header .subtitle {
                font-size: 0.9em;
            }

            .lc-amount {
                font-size: 1.1em;
            }

            .summary-item {
                padding: 12px;
            }

            .dashboard h2,
            .contact-section h2 {
                font-size: 1.2em;
            }

            .status-item {
                padding: 12px;
            }

            .table {
                font-size: 0.8em;
                min-width: 600px; /* Ensures table doesn't get too cramped */
            }

            .table th,
            .table td {
                padding: 6px;
                min-width: 80px;
            }

            .lc-number {
                font-size: 0.9em;
                word-break: break-all;
            }

            .bulk-dropdown {
                font-size: 0.6em;
                padding: 1px;
                margin-top: 1px;
            }

            .bulk-update-btn {
                font-size: 0.6em;
                padding: 1px 3px;
                margin-top: 1px;
            }

            .export-section {
                padding: 15px;
                margin: 15px 0;
            }

            .export-buttons {
                flex-direction: column;
                gap: 10px;
            }

            .export-btn {
                width: 100%;
                justify-content: center;
                font-size: 0.9em;
                padding: 10px 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Letter of Credit Renewal Applications</h1>
            <div class="subtitle">Comprehensive Documentation - Updated June 16, 2025</div>
        </div>

        <div class="content">
            <div class="dashboard">
                <h2>🎯 Executive Dashboard - LC Renewal Status</h2>
                
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 100%;"></div>
                    <div class="progress-text">Overall Progress: 100% Complete</div>
                </div>

                <div class="status-grid">
                    <div class="status-item pending">
                        <strong>Days Remaining</strong><br>
                        <span style="font-size: 1.4em; color: #f59e0b;">14 Days</span><br>
                        Until June 30, 2025
                    </div>
                    <div class="status-item completed" id="doc-prep-status">
                <strong>Doc Prep Complete</strong><br>
                <span style="font-size: 1.2em;">11 of 11 LCs</span><br>
                Documents Ready
            </div>
                    <div class="status-item completed" id="approval-status">
                <strong>Internal Approvals</strong><br>
                <span style="font-size: 1.2em;">11 of 11 LCs</span><br>
                Internally Approved
            </div>
                    <div class="status-item completed" id="completion-status">
                <strong>Final Completion</strong><br>
                <span style="font-size: 1.2em;">11 of 11 LCs</span><br>
                Fully Renewed
            </div>
                    <div class="status-item at-risk">
                        <strong>Critical Path</strong><br>
                        <span style="font-size: 1.2em;">HSBC Submission</span><br>
                        Due by June 25th
                    </div>
                    <div class="status-item pending">
                        <strong>Total Value</strong><br>
                        <span style="font-size: 1.2em;">$1,780,026</span><br>
                        Being Renewed
                    </div>
                </div>

                <div style="overflow-x: auto;">
                    <table class="lc-status-table">
                        <thead>
                            <tr>
                                <th>LC Number</th>
                                <th>Entity</th>
                                <th>Amount</th>
                                <th>Status</th>
                                <th class="column-header">
                                    Doc Prep
                                    <select class="bulk-dropdown" id="bulk-doc-prep">
                                        <option value="">Select All...</option>
                                        <option value="Not Started">Not Started</option>
                                        <option value="In Progress">In Progress</option>
                                        <option value="Complete">Complete</option>
                                    </select>
                                    <button class="bulk-update-btn" onclick="bulkUpdate(0, 'bulk-doc-prep')">Apply</button>
                                </th>
                                <th class="column-header">
                                    Internal Approval
                                    <select class="bulk-dropdown" id="bulk-approval">
                                        <option value="">Select All...</option>
                                        <option value="Pending">Pending</option>
                                        <option value="Approved">Approved</option>
                                        <option value="Rejected">Rejected</option>
                                    </select>
                                    <button class="bulk-update-btn" onclick="bulkUpdate(1, 'bulk-approval')">Apply</button>
                                </th>
                                <th class="column-header">
                                    HSBC Submission
                                    <select class="bulk-dropdown" id="bulk-submission">
                                        <option value="">Select All...</option>
                                        <option value="Not Submitted">Not Submitted</option>
                                        <option value="Submitted">Submitted</option>
                                        <option value="Processing">Processing</option>
                                    </select>
                                    <button class="bulk-update-btn" onclick="bulkUpdate(2, 'bulk-submission')">Apply</button>
                                </th>
                                <th class="column-header">
                                    Confirmation
                                    <select class="bulk-dropdown" id="bulk-confirmation">
                                        <option value="">Select All...</option>
                                        <option value="Pending">Pending</option>
                                        <option value="Confirmed">Confirmed</option>
                                    </select>
                                    <button class="bulk-update-btn" onclick="bulkUpdate(3, 'bulk-confirmation')">Apply</button>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>SDCMTN578255</td>
                                <td>BD Solar 1 LLC</td>
                                <td>$368,400</td>
                                <td><span class="status-indicator completed"></span>Completed</td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option>Not Started</option>
                                        <option>In Progress</option>
                                        <option>Complete</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option>Pending</option>
                                        <option>Approved</option>
                                        <option>Rejected</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option>Not Submitted</option>
                                        <option>Submitted</option>
                                        <option>Processing</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option>Pending</option>
                                        <option>Confirmed</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>SDCMTN578939</td>
                                <td>Maine DEP</td>
                                <td>$210,399</td>
                                <td><span class="status-indicator completed"></span>Completed</td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option>Not Started</option>
                                        <option selected="">In Progress</option>
                                        <option>Complete</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Pending</option>
                                        <option>Approved</option>
                                        <option>Rejected</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Not Submitted</option>
                                        <option>Submitted</option>
                                        <option>Processing</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Pending</option>
                                        <option>Confirmed</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>SDCMTN578276</td>
                                <td>BD Solar Oxford LLC</td>
                                <td>$169,464</td>
                                <td><span class="status-indicator completed"></span>Completed</td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Not Started</option>
                                        <option>In Progress</option>
                                        <option>Complete</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Pending</option>
                                        <option>Approved</option>
                                        <option>Rejected</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Not Submitted</option>
                                        <option>Submitted</option>
                                        <option>Processing</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Pending</option>
                                        <option>Confirmed</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>SDCMTN579382</td>
                                <td>Town of Hancock (Hancock LLC)</td>
                                <td>$157,581</td>
                                <td><span class="status-indicator completed"></span>Completed</td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Not Started</option>
                                        <option>In Progress</option>
                                        <option>Complete</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Pending</option>
                                        <option>Approved</option>
                                        <option>Rejected</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Not Submitted</option>
                                        <option>Submitted</option>
                                        <option>Processing</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Pending</option>
                                        <option>Confirmed</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>SDCMTN579381</td>
                                <td>Town of Hancock (Hancock North)</td>
                                <td>$157,581</td>
                                <td><span class="status-indicator completed"></span>Completed</td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Not Started</option>
                                        <option>In Progress</option>
                                        <option>Complete</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Pending</option>
                                        <option>Approved</option>
                                        <option>Rejected</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Not Submitted</option>
                                        <option>Submitted</option>
                                        <option>Processing</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Pending</option>
                                        <option>Confirmed</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>SDCMTN578278</td>
                                <td>BD Solar Hancock LLC</td>
                                <td>$132,580</td>
                                <td><span class="status-indicator completed"></span>Completed</td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Not Started</option>
                                        <option>In Progress</option>
                                        <option>Complete</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Pending</option>
                                        <option>Approved</option>
                                        <option>Rejected</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Not Submitted</option>
                                        <option>Submitted</option>
                                        <option>Processing</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Pending</option>
                                        <option>Confirmed</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>SDCMTN578279</td>
                                <td>BD Solar Hancock North LLC</td>
                                <td>$132,580</td>
                                <td><span class="status-indicator completed"></span>Completed</td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Not Started</option>
                                        <option>In Progress</option>
                                        <option>Complete</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Pending</option>
                                        <option>Approved</option>
                                        <option>Rejected</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Not Submitted</option>
                                        <option>Submitted</option>
                                        <option>Processing</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Pending</option>
                                        <option>Confirmed</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>SDCMTN578264</td>
                                <td>BD Solar Augusta LLC</td>
                                <td>$132,624</td>
                                <td><span class="status-indicator completed"></span>Completed</td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Not Started</option>
                                        <option>In Progress</option>
                                        <option>Complete</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Pending</option>
                                        <option>Approved</option>
                                        <option>Rejected</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Not Submitted</option>
                                        <option>Submitted</option>
                                        <option>Processing</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Pending</option>
                                        <option>Confirmed</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>SDCMTN578272</td>
                                <td>BD Solar 2 LLC (Winslow)</td>
                                <td>$132,390</td>
                                <td><span class="status-indicator completed"></span>Completed</td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Not Started</option>
                                        <option>In Progress</option>
                                        <option>Complete</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Pending</option>
                                        <option>Approved</option>
                                        <option>Rejected</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Not Submitted</option>
                                        <option>Submitted</option>
                                        <option>Processing</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Pending</option>
                                        <option>Confirmed</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>SDCMTN578275</td>
                                <td>BD Solar Palmyra LLC</td>
                                <td>$94,511</td>
                                <td><span class="status-indicator completed"></span>Completed</td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Not Started</option>
                                        <option>In Progress</option>
                                        <option>Complete</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Pending</option>
                                        <option>Approved</option>
                                        <option>Rejected</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Not Submitted</option>
                                        <option>Submitted</option>
                                        <option>Processing</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Pending</option>
                                        <option>Confirmed</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>SDCMTN578265</td>
                                <td>BD Solar Fairfield LLC</td>
                                <td>$91,916</td>
                                <td><span class="status-indicator completed"></span>Completed</td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Not Started</option>
                                        <option>In Progress</option>
                                        <option>Complete</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Pending</option>
                                        <option>Approved</option>
                                        <option>Rejected</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Not Submitted</option>
                                        <option>Submitted</option>
                                        <option>Processing</option>
                                    </select>
                                </td>
                                <td>
                                    <select class="status-dropdown" style="">
                                        <option selected="">Pending</option>
                                        <option>Confirmed</option>
                                    </select>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="contact-section">
                <h2>📞 Key Contacts - Editable Reference</h2>
                
                <div class="contact-grid">
                    <div class="contact-card">
                        <h4>HSBC Primary Contacts</h4>
                        <span class="field-label">Primary Contact:</span>
                        <div class="editable-field" contenteditable="true">Click to add name</div>
                        
                        <span class="field-label">Direct Phone:</span>
                        <div class="editable-field" contenteditable="true">+1-866-327-0763</div>
                        
                        <span class="field-label">Email:</span>
                        <div class="editable-field" contenteditable="true">young.m.ku@us.hsbc.com</div>
                        
                        <span class="field-label">Escalation Contact:</span>
                        <div class="editable-field" contenteditable="true">Click to add escalation contact</div>
                    </div>

                    <div class="contact-card">
                        <h4>Internal Project Team</h4>
                        <span class="field-label">Project Manager:</span>
                        <div class="editable-field" contenteditable="true">Click to add PM name &amp; phone</div>
                        
                        <span class="field-label">Legal Counsel:</span>
                        <div class="editable-field" contenteditable="true">Click to add legal contact</div>
                        
                        <span class="field-label">Finance Contact:</span>
                        <div class="editable-field" contenteditable="true">Click to add finance contact</div>
                        
                        <span class="field-label">Executive Sponsor:</span>
                        <div class="editable-field" contenteditable="true">Mariah Shones (Authorized Signatory)</div>
                    </div>

                    <div class="contact-card">
                        <h4>Beneficiary Contacts</h4>
                        <span class="field-label">Central Maine Power:</span>
                        <div class="editable-field" contenteditable="true">ANNA KARLSSON, ELECTRIC SUPPLY</div>
                        
                        <span class="field-label">Versant Power:</span>
                        <div class="editable-field" contenteditable="true">Legal Notices Dept.</div>
                        
                        <span class="field-label">Maine DEP:</span>
                        <div class="editable-field" contenteditable="true">Click to add specific contact</div>
                        
                        <span class="field-label">Town of Hancock:</span>
                        <div class="editable-field" contenteditable="true">Click to add municipal contact</div>
                    </div>

                    <div class="contact-card">
                        <h4>Emergency/Backup Contacts</h4>
                        <span class="field-label">HSBC After Hours:</span>
                        <div class="editable-field" contenteditable="true">Click to add emergency number</div>
                        
                        <span class="field-label">Internal Backup Signatory:</span>
                        <div class="editable-field" contenteditable="true">Click to add backup authorized person</div>
                        
                        <span class="field-label">External Counsel:</span>
                        <div class="editable-field" contenteditable="true">Click to add law firm contact</div>
                        
                        <span class="field-label">Carlyle Group Contact:</span>
                        <div class="editable-field" contenteditable="true">Click to add sponsor contact</div>
                    </div>
                </div>

                <div style="background: #fef7ed; border: 1px solid #f59e0b; border-radius: 6px; padding: 12px; margin-top: 15px;">
                    <strong>💾 Session Storage:</strong> All changes to dropdowns and contact information are saved in memory during your current session. Changes persist while using the document but will reset if you refresh the page. For permanent backup, copy your edits or export to PDF before closing.
                </div>
            </div>
            <div class="export-section">
                <h2>💾 Save &amp; Export Options</h2>
                <p>Save your progress and changes permanently using the options below:</p>
                
                <div class="export-buttons">
                    <button class="export-btn" onclick="exportAsHTML()">
                        📄 Download Complete HTML
                    </button>
                    <button class="export-btn" onclick="exportData()">
                        📊 Export Progress Data
                    </button>
                    <button class="export-btn secondary" onclick="importData()">
                        📁 Import Progress Data
                    </button>
                    <button class="export-btn secondary" onclick="printToPDF()">
                        🖨️ Print/Save as PDF
                    </button>
                </div>
                
                <div style="background: #fefce8; border: 1px solid #eab308; border-radius: 6px; padding: 12px; margin-top: 15px;">
                    <strong>💡 Recommended:</strong> Use "Download Complete HTML" to save the entire document with all your changes. You can then open the downloaded file in any browser and continue working with all your progress intact!
                </div>
            </div>

            <div class="executive-summary">
                <h2>Executive Summary</h2>
                <div class="summary-grid">
                    <div class="summary-item">
                        <strong>Total LCs:</strong>
                        11 (all with June 30, 2025 hard expiry)
                    </div>
                    <div class="summary-item">
                        <strong>Total Portfolio Value:</strong>
                        $1,780,026
                    </div>
                    <div class="summary-item">
                        <strong>Current Expiry:</strong>
                        June 30, 2025
                    </div>
                    <div class="summary-item">
                        <strong>Renewal Period:</strong>
                        One year to June 30, 2026
                    </div>
                    <div class="summary-item">
                        <strong>Processing Bank:</strong>
                        HSBC Bank USA, National Association
                    </div>
                    <div class="summary-item">
                        <strong>Authorized Signatory:</strong>
                        Mariah Shones
                    </div>
                    <div class="summary-item">
                        <strong>Applicant (All LCs):</strong>
                        Acadia Borrower LLC
                    </div>
                    <div class="summary-item">
                        <strong>Excluded:</strong>
                        ISO-NE LC (evergreen, no hard expiry)
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">I. CENTRAL MAINE POWER COMPANY LCs (5 Total)</div>

                <div class="lc-card">
                    <div class="lc-header">
                        <div class="lc-number">1. BD Solar Augusta LLC - SDCMTN578264</div>
                        <div class="lc-amount">USD $132,624.00</div>
                        <span class="tag utility">Utility PPA</span>
                    </div>
                    <div class="lc-body">
                        <div class="detail-grid">
                            <div class="detail-group">
                                <h4>LC Details</h4>
                                <p><strong>Previous Amount:</strong> $144,000.00 (reduced December 2024)</p>
                                <p><strong>Original Issue Date:</strong> November 25, 2020</p>
                                <p><strong>Purpose:</strong> Power Purchase Agreement performance security</p>
                                <p><strong>Contact:</strong> Adam Carte | +1 (617) 315-4822</p>
                            </div>
                            <div class="detail-group">
                                <h4>Beneficiary</h4>
                                <p><strong>Central Maine Power Company</strong></p>
                                <p>83 Edison Drive, Augusta, ME 04336</p>
                                <p><strong>Attention:</strong> ANNA KARLSSON, ELECTRIC SUPPLY</p>
                                <p><em>Previous Contact: DIANA MORGAN</em></p>
                            </div>
                        </div>
                        <div class="renewal-terms">
                            <h4>Renewal Terms</h4>
                            <p>Extend expiry date from June 30, 2025 to June 30, 2026. All other terms and conditions remain unchanged.</p>
                        </div>
                    </div>
                </div>

                <div class="lc-card">
                    <div class="lc-header">
                        <div class="lc-number">2. BD Solar 2 LLC (Winslow) - SDCMTN578272</div>
                        <div class="lc-amount">USD $132,390.00</div>
                        <span class="tag utility">Utility PPA</span><span class="tag regulatory">Also has Maine DEP LC</span>
                    </div>
                    <div class="lc-body">
                        <div class="detail-grid">
                            <div class="detail-group">
                                <h4>LC Details</h4>
                                <p><strong>Previous Amount:</strong> $139,980.00 (reduced December 2024)</p>
                                <p><strong>Original Issue Date:</strong> November 25, 2020</p>
                                <p><strong>Purpose:</strong> Power Purchase Agreement performance security</p>
                            </div>
                            <div class="detail-group">
                                <h4>Beneficiary</h4>
                                <p><strong>Central Maine Power Company</strong></p>
                                <p>83 Edison Drive, Augusta, ME 04336</p>
                                <p><strong>Attention:</strong> ANNA KARLSSON, ELECTRIC SUPPLY</p>
                            </div>
                        </div>
                        <div class="note">
                            <strong>Note:</strong> Entity name is "BD Solar 2 LLC" not "BD Solar Winslow LLC". This entity also has the Maine DEP LC (SDCMTN578939) for decommissioning.
                        </div>
                        <div class="renewal-terms">
                            <h4>Renewal Terms</h4>
                            <p>Extend expiry date from June 30, 2025 to June 30, 2026. All other terms and conditions remain unchanged.</p>
                        </div>
                    </div>
                </div>

                <div class="lc-card">
                    <div class="lc-header">
                        <div class="lc-number">3. BD Solar Fairfield LLC - SDCMTN578265</div>
                        <div class="lc-amount">USD $91,916.00</div>
                        <span class="tag utility">Utility PPA</span><span class="tag">ISO-NE Parent</span>
                    </div>
                    <div class="lc-body">
                        <div class="detail-grid">
                            <div class="detail-group">
                                <h4>LC Details</h4>
                                <p><strong>Previous Amount:</strong> $99,800.00 (reduced December 2024)</p>
                                <p><strong>Original Issue Date:</strong> November 25, 2020</p>
                                <p><strong>Purpose:</strong> Power Purchase Agreement performance security</p>
                            </div>
                            <div class="detail-group">
                                <h4>Beneficiary</h4>
                                <p><strong>Central Maine Power Company</strong></p>
                                <p>83 Edison Drive, Augusta, ME 04336</p>
                                <p><strong>Attention:</strong> ANNA KARLSSON, ELECTRIC SUPPLY</p>
                            </div>
                        </div>
                        <div class="note">
                            <strong>Additional Notes:</strong> BD Solar Fairfield LLC also has ISO New England obligations under parent entity. See ISO-NE LC (SDCMTN580588) under Acadia Renewable Energy LLC.
                        </div>
                        <div class="renewal-terms">
                            <h4>Renewal Terms</h4>
                            <p>Extend expiry date from June 30, 2025 to June 30, 2026. All other terms and conditions remain unchanged.</p>
                        </div>
                    </div>
                </div>

                <div class="lc-card">
                    <div class="lc-header">
                        <div class="lc-number">4. BD Solar Oxford LLC - SDCMTN578276</div>
                        <div class="lc-amount">USD $169,464.00</div>
                        <span class="tag utility">Utility PPA</span><span class="tag">Largest CMP LC</span>
                    </div>
                    <div class="lc-body">
                        <div class="detail-grid">
                            <div class="detail-group">
                                <h4>LC Details</h4>
                                <p><strong>Previous Amount:</strong> $184,000.00 (reduced December 2024)</p>
                                <p><strong>Original Issue Date:</strong> November 25, 2020</p>
                                <p><strong>Purpose:</strong> Power Purchase Agreement performance security</p>
                            </div>
                            <div class="detail-group">
                                <h4>Beneficiary</h4>
                                <p><strong>Central Maine Power Company</strong></p>
                                <p>83 Edison Drive, Augusta, ME 04336</p>
                                <p><strong>Attention:</strong> ANNA KARLSSON, ELECTRIC SUPPLY</p>
                            </div>
                        </div>
                        <div class="renewal-terms">
                            <h4>Renewal Terms</h4>
                            <p>Extend expiry date from June 30, 2025 to June 30, 2026. All other terms and conditions remain unchanged.</p>
                        </div>
                    </div>
                </div>

                <div class="lc-card">
                    <div class="lc-header">
                        <div class="lc-number">5. BD Solar Palmyra LLC - SDCMTN578275</div>
                        <div class="lc-amount">USD $94,511.00</div>
                        <span class="tag utility">Utility PPA</span>
                    </div>
                    <div class="lc-body">
                        <div class="detail-grid">
                            <div class="detail-group">
                                <h4>LC Details</h4>
                                <p><strong>Previous Amount:</strong> $99,800.00 (reduced December 2024)</p>
                                <p><strong>Original Issue Date:</strong> November 25, 2020</p>
                                <p><strong>Purpose:</strong> Power Purchase Agreement performance security</p>
                            </div>
                            <div class="detail-group">
                                <h4>Beneficiary</h4>
                                <p><strong>Central Maine Power Company</strong></p>
                                <p>83 Edison Drive, Augusta, ME 04336</p>
                                <p><strong>Attention:</strong> ANNA KARLSSON, ELECTRIC SUPPLY</p>
                            </div>
                        </div>
                        <div class="renewal-terms">
                            <h4>Renewal Terms</h4>
                            <p>Extend expiry date from June 30, 2025 to June 30, 2026. All other terms and conditions remain unchanged.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">II. VERSANT POWER LCs (3 Total)</div>

                <div class="lc-card">
                    <div class="lc-header">
                        <div class="lc-number">6. BD Solar 1 LLC (Milo) - SDCMTN578255</div>
                        <div class="lc-amount">USD $368,400.00</div>
                        <span class="tag utility">Utility PPA</span><span class="tag highlight">Largest Single LC</span>
                    </div>
                    <div class="lc-body">
                        <div class="detail-grid">
                            <div class="detail-group">
                                <h4>LC Details</h4>
                                <p><strong>Previous Amount:</strong> $400,000.00 (reduced December 2024)</p>
                                <p><strong>Original Issue Date:</strong> November 25, 2020</p>
                                <p><strong>Purpose:</strong> Power Purchase Agreement performance security</p>
                            </div>
                            <div class="detail-group">
                                <h4>Beneficiary</h4>
                                <p><strong>Versant Power</strong></p>
                                <p>28 Penobscot Meadow Drive, Hampden, ME 04444</p>
                                <p><strong>Attention:</strong> Legal Notices</p>
                                <p><em>Previous Contact: DEBORAH MANNING, PE (updated February 2025)</em></p>
                            </div>
                        </div>
                        <div class="renewal-terms">
                            <h4>Renewal Terms</h4>
                            <p>Extend expiry date from June 30, 2025 to June 30, 2026. All other terms and conditions remain unchanged.</p>
                        </div>
                    </div>
                </div>

                <div class="lc-card">
                    <div class="lc-header">
                        <div class="lc-number">7. BD Solar Hancock LLC - SDCMTN578278</div>
                        <div class="lc-amount">USD $132,580.00</div>
                        <span class="tag utility">Utility PPA</span><span class="tag municipal">Also has Town LC</span>
                    </div>
                    <div class="lc-body">
                        <div class="detail-grid">
                            <div class="detail-group">
                                <h4>LC Details</h4>
                                <p><strong>Previous Amount:</strong> $139,800.00 (reduced via Amendment No. 008, January 7, 2025)</p>
                                <p><strong>Original Issue Date:</strong> November 25, 2020</p>
                                <p><strong>Initial Amount:</strong> $34,950.00 (subsequently increased)</p>
                                <p><strong>Purpose:</strong> Power Purchase Agreement performance security</p>
                            </div>
                            <div class="detail-group">
                                <h4>Beneficiary</h4>
                                <p><strong>Versant Power</strong></p>
                                <p>28 Penobscot Meadow Drive, Hampden, ME 04444</p>
                                <p><strong>Attention:</strong> Legal Notices (updated from DEBORAH MANNING, PE)</p>
                            </div>
                        </div>
                        <div class="note">
                            <strong>Amendment History:</strong> Amendment No. 007: January 7, 2025 | Amendment No. 008: February 10, 2025 (beneficiary attention line update)
                        </div>
                        <div class="renewal-terms">
                            <h4>Renewal Terms</h4>
                            <p>Extend expiry date from June 30, 2025 to June 30, 2026. All other terms and conditions remain unchanged.</p>
                        </div>
                    </div>
                </div>

                <div class="lc-card">
                    <div class="lc-header">
                        <div class="lc-number">8. BD Solar Hancock North LLC - SDCMTN578279</div>
                        <div class="lc-amount">USD $132,580.00</div>
                        <span class="tag utility">Utility PPA</span><span class="tag municipal">Also has Town LC</span>
                    </div>
                    <div class="lc-body">
                        <div class="detail-grid">
                            <div class="detail-group">
                                <h4>LC Details</h4>
                                <p><strong>Previous Amount:</strong> $139,800.00 (reduced via Amendment No. 008, January 7, 2025)</p>
                                <p><strong>Original Issue Date:</strong> November 25, 2020</p>
                                <p><strong>Purpose:</strong> Power Purchase Agreement performance security</p>
                            </div>
                            <div class="detail-group">
                                <h4>Beneficiary</h4>
                                <p><strong>Versant Power</strong></p>
                                <p>28 Penobscot Meadow Drive, Hampden, ME 04444</p>
                                <p><strong>Attention:</strong> Legal Notices (updated from DEBORAH MANNING, PE)</p>
                            </div>
                        </div>
                        <div class="note">
                            <strong>Amendment History:</strong> Amendment No. 009: February 10, 2025 (amount reduction and beneficiary update)
                        </div>
                        <div class="renewal-terms">
                            <h4>Renewal Terms</h4>
                            <p>Extend expiry date from June 30, 2025 to June 30, 2026. All other terms and conditions remain unchanged.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">III. REGULATORY &amp; MUNICIPAL LCs (3 Total)</div>

                <div class="lc-card">
                    <div class="lc-header">
                        <div class="lc-number">9. Maine Department of Environmental Protection - SDCMTN578939</div>
                        <div class="lc-amount">USD $210,399.00</div>
                        <span class="tag regulatory">Decommissioning</span><span class="tag">UCP 600</span>
                    </div>
                    <div class="lc-body">
                        <div class="detail-grid">
                            <div class="detail-group">
                                <h4>LC Details</h4>
                                <p><strong>Original Issue Date:</strong> February 12, 2021</p>
                                <p><strong>Purpose:</strong> Decommissioning expenses per permit requirements</p>
                                <p><strong>Entity Association:</strong> BD Solar 2 LLC</p>
                                <p><strong>Governing Rules:</strong> UCP 600 (Uniform Customs and Practice for Documentary Credits)</p>
                            </div>
                            <div class="detail-group">
                                <h4>Beneficiary</h4>
                                <p><strong>Maine Department of Environmental Protection</strong></p>
                                <p>17 State House Station</p>
                                <p>28 Tyson Drive, Augusta, Maine 04333</p>
                            </div>
                        </div>
                        <div class="note">
                            <strong>Critical Notes:</strong> Largest regulatory LC. Covers decommissioning obligations for BD Solar 2 LLC specifically. Different governing rules than other LCs (UCP 600 vs ISP98). Allows drawings for "nonpayment of decommissioning expenses".
                        </div>
                        <div class="renewal-terms">
                            <h4>Renewal Terms</h4>
                            <p>Extend expiry date from June 30, 2025 to June 30, 2026. All other terms and conditions remain unchanged.</p>
                        </div>
                    </div>
                </div>

                <div class="lc-card">
                    <div class="lc-header">
                        <div class="lc-number">10. Town of Hancock - BD Solar Hancock LLC - SDCMTN579382</div>
                        <div class="lc-amount">USD $157,581.00</div>
                        <span class="tag municipal">Municipal Decommissioning</span><span class="tag">UCP 600</span>
                    </div>
                    <div class="lc-body">
                        <div class="detail-grid">
                            <div class="detail-group">
                                <h4>LC Details</h4>
                                <p><strong>Original Issue Date:</strong> March 29, 2021</p>
                                <p><strong>Purpose:</strong> Decommissioning expenses per permit requirements</p>
                                <p><strong>Associated Entity:</strong> BD Solar Hancock LLC</p>
                                <p><strong>Governing Rules:</strong> UCP 600</p>
                            </div>
                            <div class="detail-group">
                                <h4>Beneficiary</h4>
                                <p><strong>Town of Hancock</strong></p>
                                <p>18 Point Road</p>
                                <p>Hancock, Maine 04640</p>
                            </div>
                        </div>
                        <div class="renewal-terms">
                            <h4>Renewal Terms</h4>
                            <p>Extend expiry date from June 30, 2025 to June 30, 2026. All other terms and conditions remain unchanged.</p>
                        </div>
                    </div>
                </div>

                <div class="lc-card">
                    <div class="lc-header">
                        <div class="lc-number">11. Town of Hancock - BD Solar Hancock North LLC - SDCMTN579381</div>
                        <div class="lc-amount">USD $157,581.00</div>
                        <span class="tag municipal">Municipal Decommissioning</span><span class="tag">UCP 600</span>
                    </div>
                    <div class="lc-body">
                        <div class="detail-grid">
                            <div class="detail-group">
                                <h4>LC Details</h4>
                                <p><strong>Original Issue Date:</strong> March 29, 2021</p>
                                <p><strong>Purpose:</strong> Decommissioning expenses per permit requirements</p>
                                <p><strong>Associated Entity:</strong> BD Solar Hancock North LLC</p>
                                <p><strong>Governing Rules:</strong> UCP 600</p>
                            </div>
                            <div class="detail-group">
                                <h4>Beneficiary</h4>
                                <p><strong>Town of Hancock</strong></p>
                                <p>18 Point Road</p>
                                <p>Hancock, Maine 04640</p>
                            </div>
                        </div>
                        <div class="note">
                            <strong>Critical Notes:</strong> Same amount as other Town of Hancock LC. Both Town of Hancock LCs cover decommissioning (like Maine DEP). Two separate LCs for two separate project entities in same municipality.
                        </div>
                        <div class="renewal-terms">
                            <h4>Renewal Terms</h4>
                            <p>Extend expiry date from June 30, 2025 to June 30, 2026. All other terms and conditions remain unchanged.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">IV. HSBC PROCESSING INFORMATION</div>
                
                <div class="detail-grid">
                    <div class="detail-group">
                        <h4>Bank Details</h4>
                        <p><strong>HSBC Bank USA, National Association</strong></p>
                        <p>Global Trade Solutions</p>
                        <p>Hudson Yards, The Spiral</p>
                        <p>66 Hudson Blvd. East, New York, NY 10001</p>
                        <p><em>Legacy Address (on older documents): 452 Fifth Avenue, New York, NY 10018</em></p>
                    </div>
                    <div class="detail-group">
                        <h4>Key Contacts</h4>
                        <p><strong>Client Services:</strong> young.m.ku@us.hsbc.com</p>
                        <p><strong>Phone:</strong> 1-866-327-0763</p>
                        <p><strong>Fax:</strong> 1-718-488-4909</p>
                    </div>
                </div>

                <div class="note">
                    <strong>Processing Notes:</strong> All LCs subject to HSBC Standard Trade Terms. Governing Rules: International Standby Practices ISP98. Auto-renewal provisions subject to June 30, 2025 final expiry date. Drawings permitted via fax with telephone pre-advice.
                </div>
            </div>

            <div class="action-items">
                <h3>V. CRITICAL ACTION ITEMS</h3>
                
                <h4>All Information Now Complete:</h4>
                <ul class="checklist">
                    <li>All beneficiary addresses confirmed</li>
                    <li>All entity associations confirmed</li>
                    <li>All LC purposes identified</li>
                </ul>

                <h4>LC Categories by Purpose:</h4>
                <p><strong>Power Purchase Agreements (8 LCs):</strong> All utility LCs (CMP &amp; Versant) - ISP98</p>
                <p><strong>Decommissioning Security (3 LCs):</strong> Maine DEP &amp; both Town of Hancock - UCP 600</p>
                <p><strong>Grid Interconnection (1 LC):</strong> ISO New England (not being renewed)</p>

                <h4>Post-Submission:</h4>
                <ul>
                    <li>Track DocuSign completion by Mariah Shones</li>
                    <li>Obtain renewal confirmations from HSBC</li>
                    <li>Update LC tracking systems with new expiry dates</li>
                    <li>Calendar next renewal cycle for May 2026</li>
                </ul>

                <h4>Risk Mitigation:</h4>
                <ul>
                    <li>All LCs have been reduced from original amounts (average 8.4% reduction)</li>
                    <li>Indicates successful de-risking of portfolio</li>
                    <li>Consider further reductions in 2026 renewal cycle</li>
                </ul>
            </div>

            <div class="section">
                <div class="section-header">VI. PORTFOLIO SUMMARY</div>

                <div class="table-wrapper">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Entity</th>
                                <th>LC Number</th>
                                <th>Beneficiary</th>
                                <th>Amount</th>
                                <th>Purpose</th>
                            </tr>
                        </thead>
                    <tbody>
                        <tr>
                            <td>BD Solar 1 LLC (Milo)</td>
                            <td>SDCMTN578255</td>
                            <td>Versant Power</td>
                            <td>$368,400.00</td>
                            <td>PPA Security</td>
                        </tr>
                        <tr>
                            <td>Maine DEP</td>
                            <td>SDCMTN578939</td>
                            <td>Maine DEP</td>
                            <td>$210,399.00</td>
                            <td>Decommissioning</td>
                        </tr>
                        <tr>
                            <td>BD Solar Oxford LLC</td>
                            <td>SDCMTN578276</td>
                            <td>Central Maine Power</td>
                            <td>$169,464.00</td>
                            <td>PPA Security</td>
                        </tr>
                        <tr>
                            <td>BD Solar Hancock LLC</td>
                            <td>SDCMTN579382</td>
                            <td>Town of Hancock</td>
                            <td>$157,581.00</td>
                            <td>Decommissioning</td>
                        </tr>
                        <tr>
                            <td>BD Solar Hancock North LLC</td>
                            <td>SDCMTN579381</td>
                            <td>Town of Hancock</td>
                            <td>$157,581.00</td>
                            <td>Decommissioning</td>
                        </tr>
                        <tr>
                            <td>BD Solar Hancock LLC</td>
                            <td>SDCMTN578278</td>
                            <td>Versant Power</td>
                            <td>$132,580.00</td>
                            <td>PPA Security</td>
                        </tr>
                        <tr>
                            <td>BD Solar Hancock North LLC</td>
                            <td>SDCMTN578279</td>
                            <td>Versant Power</td>
                            <td>$132,580.00</td>
                            <td>PPA Security</td>
                        </tr>
                        <tr>
                            <td>BD Solar Augusta LLC</td>
                            <td>SDCMTN578264</td>
                            <td>Central Maine Power</td>
                            <td>$132,624.00</td>
                            <td>PPA Security</td>
                        </tr>
                        <tr>
                            <td>BD Solar 2 LLC (Winslow)</td>
                            <td>SDCMTN578272</td>
                            <td>Central Maine Power</td>
                            <td>$132,390.00</td>
                            <td>PPA Security</td>
                        </tr>
                        <tr>
                            <td>BD Solar Palmyra LLC</td>
                            <td>SDCMTN578275</td>
                            <td>Central Maine Power</td>
                            <td>$94,511.00</td>
                            <td>PPA Security</td>
                        </tr>
                        <tr>
                            <td>BD Solar Fairfield LLC</td>
                            <td>SDCMTN578265</td>
                            <td>Central Maine Power</td>
                            <td>$91,916.00</td>
                            <td>PPA Security</td>
                        </tr>
                    </tbody>
                </table>
                </div>

                <div class="detail-grid">
                    <div class="detail-group">
                        <h4>Financial Summary</h4>
                        <p><strong>Power Purchase Agreements (ISP98):</strong> 8 LCs totaling $1,254,565</p>
                        <p>&nbsp;&nbsp;• Central Maine Power: 5 LCs - $621,005</p>
                        <p>&nbsp;&nbsp;• Versant Power: 3 LCs - $633,560</p>
                        <p><strong>Decommissioning Security (UCP 600):</strong> 3 LCs totaling $525,461</p>
                        <p>&nbsp;&nbsp;• Maine DEP: 1 LC - $210,399</p>
                        <p>&nbsp;&nbsp;• Town of Hancock: 2 LCs - $315,162</p>
                    </div>
                    <div class="detail-group">
                        <h4>Corporate Structure Key Points</h4>
                        <p><strong>Ultimate Sponsor:</strong> The Carlyle Group</p>
                        <p><strong>Top Holdco:</strong> Acadia Renewable Energy, LLC</p>
                        <p><strong>Credit Support:</strong> Acadia Borrower LLC</p>
                        <p><strong>Tax Equity Partner:</strong> JPM Capital Corporation</p>
                        <p><strong>Total Solar Portfolio:</strong> ~100 MW across 8 projects</p>
                    </div>
                </div>
            </div>

            <div class="excluded-section">
                <h3>VII. EXCLUDED FROM RENEWAL - ISO NEW ENGLAND LC</h3>
                
                <div class="detail-grid">
                    <div class="detail-group">
                        <h4>LC Details</h4>
                        <p><strong>Entity:</strong> Acadia Renewable Energy LLC / BD Solar Fairfield</p>
                        <p><strong>LC Number:</strong> SDCMTN580588</p>
                        <p><strong>Current Amount:</strong> USD $141,862.08</p>
                        <p><strong>Original Issue Date:</strong> July 1, 2021</p>
                        <p><strong>Original Amount:</strong> $77,083.19 (increased via amendments)</p>
                        <p><strong>Purpose:</strong> Grid interconnection/market participation security</p>
                    </div>
                    <div class="detail-group">
                        <h4>Key Distinction</h4>
                        <p><strong>This LC has NO June 30, 2025 hard expiry date</strong></p>
                        <p>• Evergreen with 30-day notice provision</p>
                        <p>• Auto-renews indefinitely unless HSBC provides 30-day non-renewal notice</p>
                        <p>• Different from the 11 LCs being renewed which all have June 30, 2025 hard stop</p>
                        <p><strong>Address:</strong> One Vanderbilt Avenue, Suite 3400, New York, NY 10171</p>
                    </div>
                </div>
            </div>

            <div style="text-align: center; margin-top: 40px; padding: 20px; background: #f8f9fa; border-radius: 8px;">
                <p><em>This document contains COMPLETE information for all 11 LCs being renewed as of June 16, 2025. All beneficiary addresses, entity associations, and LC purposes have been confirmed.</em></p>
            </div>
        </div>
    </div>


<script>
    // Export functions for saving document and data - defined globally
    window.exportAsHTML = function() {
        // Get current document HTML
        const currentHTML = document.documentElement.outerHTML;
        
        // Create blob and download
        const blob = new Blob([currentHTML], { type: 'text/html' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `LC_Renewal_Progress_${new Date().toISOString().split('T')[0]}.html`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        showNotification('📄 Complete HTML document downloaded!', '#0ea5e9');
    };
    
    window.exportData = function() {
        // Get current state
        const exportState = {
            exported: new Date().toISOString(),
            dropdowns: [],
            contacts: {},
            version: "1.0"
        };
        
        // Collect dropdown states
        const rows = document.querySelectorAll('.lc-status-table tbody tr');
        rows.forEach((row, index) => {
            const dropdowns = row.querySelectorAll('.status-dropdown');
            const lcNumber = row.cells[0]?.textContent?.trim();
            const entity = row.cells[1]?.textContent?.trim();
            
            if (lcNumber && entity) {
                const rowData = {
                    lcNumber: lcNumber,
                    entity: entity,
                    docPrep: dropdowns[0]?.value || '',
                    approval: dropdowns[1]?.value || '',
                    submission: dropdowns[2]?.value || '',
                    confirmation: dropdowns[3]?.value || ''
                };
                exportState.dropdowns.push(rowData);
            }
        });
        
        // Collect contact edits
        const editableFields = document.querySelectorAll('.editable-field');
        editableFields.forEach((field, index) => {
            const label = field.previousElementSibling?.textContent || `field_${index}`;
            exportState.contacts[label] = field.textContent;
        });
        
        // Download as JSON
        const blob = new Blob([JSON.stringify(exportState, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `LC_Renewal_Data_${new Date().toISOString().split('T')[0]}.json`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        showNotification('📊 Progress data exported successfully!', '#10b981');
    };
    
    window.importData = function() {
        const input = document.createElement('input');
        input.type = 'file';
        input.accept = '.json';
        
        input.onchange = function(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importState = JSON.parse(e.target.result);
                    
                    // Restore dropdown states
                    if (importState.dropdowns) {
                        importState.dropdowns.forEach(item => {
                            // Find matching row by LC number
                            const rows = document.querySelectorAll('.lc-status-table tbody tr');
                            rows.forEach(row => {
                                const lcNumber = row.cells[0]?.textContent?.trim();
                                if (lcNumber === item.lcNumber) {
                                    const dropdowns = row.querySelectorAll('.status-dropdown');
                                    if (dropdowns[0]) dropdowns[0].value = item.docPrep || '';
                                    if (dropdowns[1]) dropdowns[1].value = item.approval || '';
                                    if (dropdowns[2]) dropdowns[2].value = item.submission || '';
                                    if (dropdowns[3]) dropdowns[3].value = item.confirmation || '';
                                }
                            });
                        });
                    }
                    
                    // Restore contact edits
                    if (importState.contacts) {
                        const editableFields = document.querySelectorAll('.editable-field');
                        editableFields.forEach((field, index) => {
                            const label = field.previousElementSibling?.textContent || `field_${index}`;
                            if (importState.contacts[label]) {
                                field.textContent = importState.contacts[label];
                            }
                        });
                    }
                    
                    // Update display
                    updateStatus();
                    
                    showNotification('📁 Data imported successfully!', '#10b981');
                    
                } catch (error) {
                    alert('Error importing data. Please check the file format.');
                }
            };
            reader.readAsText(file);
        };
        
        input.click();
    };
    
    window.printToPDF = function() {
        showNotification('🖨️ Opening print dialog - save as PDF!', '#6b7280');
        window.print();
    };

    // In-memory storage for session persistence
    let sessionState = {
        dropdowns: [],
        contacts: {}
    };

    // Function to save current state to memory
    function saveState() {
        // Save dropdown states
        const rows = document.querySelectorAll('.lc-status-table tbody tr');
        rows.forEach((row, index) => {
            const dropdowns = row.querySelectorAll('.status-dropdown');
            const rowData = [];
            dropdowns.forEach(dropdown => {
                rowData.push(dropdown.value);
            });
            if (rowData.length > 0) {
                sessionState.dropdowns[index] = rowData;
            }
        });
        
        // Save contact field edits
        const editableFields = document.querySelectorAll('.editable-field');
        editableFields.forEach((field, index) => {
            sessionState.contacts[index] = field.textContent;
        });
        
        // Show save confirmation
        showNotification('💾 Changes saved for session', '#3b82f6');
    }
    
    // Function to load saved state from memory
    function loadState() {
        // Load dropdown states
        if (sessionState.dropdowns.length > 0) {
            const rows = document.querySelectorAll('.lc-status-table tbody tr');
            rows.forEach((row, index) => {
                if (sessionState.dropdowns[index]) {
                    const dropdowns = row.querySelectorAll('.status-dropdown');
                    dropdowns.forEach((dropdown, dropdownIndex) => {
                        if (sessionState.dropdowns[index][dropdownIndex]) {
                            dropdown.value = sessionState.dropdowns[index][dropdownIndex];
                        }
                    });
                }
            });
        }
        
        // Load contact field edits
        if (Object.keys(sessionState.contacts).length > 0) {
            const editableFields = document.querySelectorAll('.editable-field');
            editableFields.forEach((field, index) => {
                if (sessionState.contacts[index]) {
                    field.textContent = sessionState.contacts[index];
                }
            });
        }
        
        // Update status after loading
        updateStatus();
    }
    
    // Enhanced notification function
    function showNotification(message, color = '#10b981') {
        const notification = document.createElement('div');
        notification.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background: ${color};
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            font-weight: 600;
            animation: slideIn 0.3s ease;
        `;
        notification.textContent = message;
        document.body.appendChild(notification);
        
        setTimeout(() => {
            notification.remove();
        }, 3000);
    }

    // Function to update status indicators and overall progress - defined globally
    function updateStatus() {
        const rows = document.querySelectorAll('.lc-status-table tbody tr');
        let totalCompleted = 0;
        let docPrepComplete = 0;
        let internalApproved = 0;
        let totalLCs = rows.length;
        
        rows.forEach(row => {
            const dropdowns = row.querySelectorAll('.status-dropdown');
            const statusIndicator = row.querySelector('.status-indicator');
            const statusText = statusIndicator.nextSibling;
            
            if (dropdowns.length === 0) return; // Skip if no dropdowns in row
            
            // Get current status from all dropdowns
            const docPrep = dropdowns[0].value;
            const approval = dropdowns[1].value;
            const submission = dropdowns[2].value;
            const confirmation = dropdowns[3].value;
            
            // Count progress for each stage
            if (docPrep === 'Complete') docPrepComplete++;
            if (approval === 'Approved') internalApproved++;
            if (confirmation === 'Confirmed') totalCompleted++;
            
            // Calculate overall status for this LC
            let overallStatus = 'pending';
            let statusLabel = 'Pending';
            
            if (confirmation === 'Confirmed') {
                overallStatus = 'completed';
                statusLabel = 'Completed';
            } else if (submission === 'Processing' || submission === 'Submitted') {
                overallStatus = 'in-progress';
                statusLabel = 'Processing';
            } else if (docPrep === 'Complete' && approval === 'Approved') {
                overallStatus = 'in-progress';
                statusLabel = 'Ready to Submit';
            } else if (docPrep === 'In Progress' || approval === 'Approved') {
                overallStatus = 'in-progress';
                statusLabel = 'In Progress';
            } else if (docPrep === 'Not Started' && approval === 'Rejected') {
                overallStatus = 'at-risk';
                statusLabel = 'At Risk';
            }
            
            // Update status indicator color and text
            statusIndicator.className = `status-indicator ${overallStatus}`;
            statusText.textContent = statusLabel;
        });
        
        // Update overall progress
        const progressPercentage = Math.round((totalCompleted / totalLCs) * 100);
        const progressFill = document.querySelector('.progress-fill');
        const progressText = document.querySelector('.progress-text');
        
        progressFill.style.width = `${progressPercentage}%`;
        progressText.textContent = `Overall Progress: ${progressPercentage}% Complete`;
        
        // Update dashboard summaries
        const docPrepStatus = document.getElementById('doc-prep-status');
        if (docPrepStatus) {
            docPrepStatus.innerHTML = `
                <strong>Doc Prep Complete</strong><br>
                <span style="font-size: 1.2em;">${docPrepComplete} of ${totalLCs} LCs</span><br>
                Documents Ready
            `;
            docPrepStatus.className = `status-item ${
                docPrepComplete === totalLCs ? 'completed' : 
                docPrepComplete > 0 ? 'in-progress' : 'pending'
            }`;
        }
        
        const approvalStatus = document.getElementById('approval-status');
        if (approvalStatus) {
            approvalStatus.innerHTML = `
                <strong>Internal Approvals</strong><br>
                <span style="font-size: 1.2em;">${internalApproved} of ${totalLCs} LCs</span><br>
                Internally Approved
            `;
            approvalStatus.className = `status-item ${
                internalApproved === totalLCs ? 'completed' : 
                internalApproved > 0 ? 'in-progress' : 'pending'
            }`;
        }
        
        const completionStatus = document.getElementById('completion-status');
        if (completionStatus) {
            completionStatus.innerHTML = `
                <strong>Final Completion</strong><br>
                <span style="font-size: 1.2em;">${totalCompleted} of ${totalLCs} LCs</span><br>
                Fully Renewed
            `;
            completionStatus.className = `status-item ${
                totalCompleted === totalLCs ? 'completed' : 
                totalCompleted > 0 ? 'in-progress' : 'pending'
            }`;
        }
    }

    // Bulk update function - defined globally
    function bulkUpdate(columnIndex, bulkDropdownId) {
        const bulkDropdown = document.getElementById(bulkDropdownId);
        const selectedValue = bulkDropdown.value;
        
        if (!selectedValue) {
            alert('Please select a status to apply to all LCs');
            return;
        }
        
        // Get all rows in the table
        const rows = document.querySelectorAll('.lc-status-table tbody tr');
        let updatedCount = 0;
        
        rows.forEach(row => {
            const dropdowns = row.querySelectorAll('.status-dropdown');
            if (dropdowns.length > columnIndex) {
                dropdowns[columnIndex].value = selectedValue;
                
                // Add visual feedback
                dropdowns[columnIndex].style.background = '#dcfce7';
                setTimeout(() => {
                    dropdowns[columnIndex].style.background = '';
                }, 800);
                
                updatedCount++;
            }
        });
        
        // Reset the bulk dropdown
        bulkDropdown.value = '';
        
        // Update all status indicators
        updateStatus();
        
        // Show confirmation
        const confirmMsg = `✅ Updated ${updatedCount} LCs to "${selectedValue}"`;
        
        // Create a temporary notification
        const notification = document.createElement('div');
        notification.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background: #10b981;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            font-weight: 600;
            animation: slideIn 0.3s ease;
        `;
        notification.textContent = confirmMsg;
        document.body.appendChild(notification);
        
        // Remove notification after 3 seconds
        setTimeout(() => {
            notification.remove();
        }, 3000);
    }

document.addEventListener('DOMContentLoaded', function() {
    // Function to update status indicators and overall progress
    function updateStatus() {
        const rows = document.querySelectorAll('.lc-status-table tbody tr');
        let totalCompleted = 0;
        let docPrepComplete = 0;
        let internalApproved = 0;
        let totalLCs = rows.length;
        
        rows.forEach(row => {
            const dropdowns = row.querySelectorAll('.status-dropdown');
            const statusIndicator = row.querySelector('.status-indicator');
            const statusText = statusIndicator.nextSibling;
            
            if (dropdowns.length === 0) return; // Skip if no dropdowns in row
            
            // Get current status from all dropdowns
            const docPrep = dropdowns[0].value;
            const approval = dropdowns[1].value;
            const submission = dropdowns[2].value;
            const confirmation = dropdowns[3].value;
            
            // Count progress for each stage
            if (docPrep === 'Complete') docPrepComplete++;
            if (approval === 'Approved') internalApproved++;
            if (confirmation === 'Confirmed') totalCompleted++;
            
            // Calculate overall status for this LC
            let overallStatus = 'pending';
            let statusLabel = 'Pending';
            
            if (confirmation === 'Confirmed') {
                overallStatus = 'completed';
                statusLabel = 'Completed';
            } else if (submission === 'Processing' || submission === 'Submitted') {
                overallStatus = 'in-progress';
                statusLabel = 'Processing';
            } else if (docPrep === 'Complete' && approval === 'Approved') {
                overallStatus = 'in-progress';
                statusLabel = 'Ready to Submit';
            } else if (docPrep === 'In Progress' || approval === 'Approved') {
                overallStatus = 'in-progress';
                statusLabel = 'In Progress';
            } else if (docPrep === 'Not Started' && approval === 'Rejected') {
                overallStatus = 'at-risk';
                statusLabel = 'At Risk';
            }
            
            // Update status indicator color and text
            statusIndicator.className = `status-indicator ${overallStatus}`;
            statusText.textContent = statusLabel;
        });
        
        // Update overall progress
        const progressPercentage = Math.round((totalCompleted / totalLCs) * 100);
        const progressFill = document.querySelector('.progress-fill');
        const progressText = document.querySelector('.progress-text');
        
        progressFill.style.width = `${progressPercentage}%`;
        progressText.textContent = `Overall Progress: ${progressPercentage}% Complete`;
        
        // Update dashboard summaries
        const docPrepStatus = document.getElementById('doc-prep-status');
        if (docPrepStatus) {
            docPrepStatus.innerHTML = `
                <strong>Doc Prep Complete</strong><br>
                <span style="font-size: 1.2em;">${docPrepComplete} of ${totalLCs} LCs</span><br>
                Documents Ready
            `;
            docPrepStatus.className = `status-item ${
                docPrepComplete === totalLCs ? 'completed' : 
                docPrepComplete > 0 ? 'in-progress' : 'pending'
            }`;
        }
        
        const approvalStatus = document.getElementById('approval-status');
        if (approvalStatus) {
            approvalStatus.innerHTML = `
                <strong>Internal Approvals</strong><br>
                <span style="font-size: 1.2em;">${internalApproved} of ${totalLCs} LCs</span><br>
                Internally Approved
            `;
            approvalStatus.className = `status-item ${
                internalApproved === totalLCs ? 'completed' : 
                internalApproved > 0 ? 'in-progress' : 'pending'
            }`;
        }
        
        const completionStatus = document.getElementById('completion-status');
        if (completionStatus) {
            completionStatus.innerHTML = `
                <strong>Final Completion</strong><br>
                <span style="font-size: 1.2em;">${totalCompleted} of ${totalLCs} LCs</span><br>
                Fully Renewed
            `;
            completionStatus.className = `status-item ${
                totalCompleted === totalLCs ? 'completed' : 
                totalCompleted > 0 ? 'in-progress' : 'pending'
            }`;
        }
    }
    // Function to update status indicators and overall progress
    function updateStatus() {
        const rows = document.querySelectorAll('.lc-status-table tbody tr');
        let totalCompleted = 0;
        let docPrepComplete = 0;
        let internalApproved = 0;
        let totalLCs = rows.length;
        
        rows.forEach(row => {
            const dropdowns = row.querySelectorAll('.status-dropdown');
            const statusIndicator = row.querySelector('.status-indicator');
            const statusText = statusIndicator.nextSibling;
            
            if (dropdowns.length === 0) return; // Skip if no dropdowns in row
            
            // Get current status from all dropdowns
            const docPrep = dropdowns[0].value;
            const approval = dropdowns[1].value;
            const submission = dropdowns[2].value;
            const confirmation = dropdowns[3].value;
            
            // Count progress for each stage
            if (docPrep === 'Complete') docPrepComplete++;
            if (approval === 'Approved') internalApproved++;
            if (confirmation === 'Confirmed') totalCompleted++;
            
            // Calculate overall status for this LC
            let overallStatus = 'pending';
            let statusLabel = 'Pending';
            
            if (confirmation === 'Confirmed') {
                overallStatus = 'completed';
                statusLabel = 'Completed';
            } else if (submission === 'Processing' || submission === 'Submitted') {
                overallStatus = 'in-progress';
                statusLabel = 'Processing';
            } else if (docPrep === 'Complete' && approval === 'Approved') {
                overallStatus = 'in-progress';
                statusLabel = 'Ready to Submit';
            } else if (docPrep === 'In Progress' || approval === 'Approved') {
                overallStatus = 'in-progress';
                statusLabel = 'In Progress';
            } else if (docPrep === 'Not Started' && approval === 'Rejected') {
                overallStatus = 'at-risk';
                statusLabel = 'At Risk';
            }
            
            // Update status indicator color and text
            statusIndicator.className = `status-indicator ${overallStatus}`;
            statusText.textContent = statusLabel;
        });
        
        // Update overall progress
        const progressPercentage = Math.round((totalCompleted / totalLCs) * 100);
        const progressFill = document.querySelector('.progress-fill');
        const progressText = document.querySelector('.progress-text');
        
        progressFill.style.width = `${progressPercentage}%`;
        progressText.textContent = `Overall Progress: ${progressPercentage}% Complete`;
        
        // Update dashboard summaries
        const docPrepStatus = document.getElementById('doc-prep-status');
        if (docPrepStatus) {
            docPrepStatus.innerHTML = `
                <strong>Doc Prep Complete</strong><br>
                <span style="font-size: 1.2em;">${docPrepComplete} of ${totalLCs} LCs</span><br>
                Documents Ready
            `;
            docPrepStatus.className = `status-item ${
                docPrepComplete === totalLCs ? 'completed' : 
                docPrepComplete > 0 ? 'in-progress' : 'pending'
            }`;
        }
        
        const approvalStatus = document.getElementById('approval-status');
        if (approvalStatus) {
            approvalStatus.innerHTML = `
                <strong>Internal Approvals</strong><br>
                <span style="font-size: 1.2em;">${internalApproved} of ${totalLCs} LCs</span><br>
                Internally Approved
            `;
            approvalStatus.className = `status-item ${
                internalApproved === totalLCs ? 'completed' : 
                internalApproved > 0 ? 'in-progress' : 'pending'
            }`;
        }
        
        const completionStatus = document.getElementById('completion-status');
        if (completionStatus) {
            completionStatus.innerHTML = `
                <strong>Final Completion</strong><br>
                <span style="font-size: 1.2em;">${totalCompleted} of ${totalLCs} LCs</span><br>
                Fully Renewed
            `;
            completionStatus.className = `status-item ${
                totalCompleted === totalLCs ? 'completed' : 
                totalCompleted > 0 ? 'in-progress' : 'pending'
            }`;
        }
    }
    
    // Add event listeners to all dropdowns
    document.querySelectorAll('.status-dropdown').forEach(dropdown => {
        dropdown.addEventListener('change', updateStatus);
    });
    
    // Initialize status on page load
    updateStatus();
    
    // Add visual feedback when dropdowns change
    document.querySelectorAll('.status-dropdown').forEach(dropdown => {
        dropdown.addEventListener('change', function() {
            this.style.background = '#dcfce7'; // Light green flash
            setTimeout(() => {
                this.style.background = '';
            }, 500);
        });
    });
});
</script>

</body></html>
